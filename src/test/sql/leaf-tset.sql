SELECT *
FROM LEAF;
SELECT *
FROM LEAF_BOOK;
DELETE
FROM LEAF;
DELETE
FROM LEAF_BOOK;
DELETE
FROM LEAF_TAG_MAP;
DELETE
FROM LEAF_LIKE;
DELETE
FROM LEAF_COMMENT_LIKE;
COMMIT;

INSERT INTO GGOGIT.MEMBER (ID, EMAIL, PASSWORD, NICKNAME, INTRODUCTION, UPDATE_TIME, CREATE_TIME, USERNAME) VALUES (1, 'test', 'test', 'test', 'test', TIMESTAMP '2024-09-04 18:01:21.091000', TIMESTAMP '2024-09-04 18:01:21.091000', 'test');
INSERT INTO GGOGIT.TREE (ID, MEMBER_ID, SEED_ID, TITLE, DESCRIPTION, BOOK_MARK_COUNT, VISIBILITY, UPDATE_TIME, CREATE_TIME, BOOK_ID) VALUES (1, 999, 1, 'testTree2', 'test입니다.2', 0, 1, TIMESTAMP '2024-09-16 22:28:47.000000', TIMESTAMP '2024-09-16 22:28:48.000000', 18);
commit;

-- TREE_ID 1
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (1,  20, null, 1, 0, 0, 'node1', 'node1', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-16 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (2,  20, 1, 1, 0, 0, 'node2', 'node2', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-17 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (3,  20, 2, 1, 0, 0, 'node3', 'node3', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-18 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (4,  20, 3, 1, 0, 0, 'node4', 'node4', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-19 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (5,  20, 2, 1, 0, 0, 'node5', 'node5', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-20 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (6,  20, 3, 1, 0, 0, 'node6', 'node6', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-21 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (7,  20, 5, 1, 0, 0, 'node7', 'node7', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-22 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (8,  20, 7, 1, 0, 0, 'node8', 'node8', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-23 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (9,  20, 2, 1, 0, 0, 'node9', 'node9', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-24 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (10, 20, 7, 1, 0, 0, 'node10', 'node10', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-25 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (11, 20, 1, 1, 0, 0, 'node11', 'node11', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-26 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (12, 20, 1, 1, 0, 0, 'node12', 'node12', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-27 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (13, 20, 12, 1, 0, 0, 'node13', 'node13', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-28 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (14, 20, 12, 1, 0, 0, 'node14', 'node14', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-29 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (15, 20, 11, 1, 0, 0, 'node15', 'node15', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-30 09:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (16, 20, 15, 1, 0, 0, 'node16', 'node16', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-30 10:17:19.994000');
INSERT INTO LEAF (ID, TREE_ID, PARENT_LEAF_ID, VISIBILITY, VIEW_COUNT, LIKE_COUNT, TITLE, CONTENT, CHILD_LEAF_COUNT, BOOK_MARK, UPDATE_TIME, CREATE_TIME) VALUES (17, 20, 15, 1, 0, 0, 'node17', 'node17', 0, 0, TIMESTAMP '2024-09-16 09:17:19.994000', TIMESTAMP '2024-09-30 11:17:19.994000');

COMMIT;

-- 태그 연동
SELECT *
FROM LEAF_TAG;



INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (1, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (1, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (1, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (2, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (2, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (2, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (3, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (3, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (3, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (4, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (4, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (4, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (5, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (5, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (5, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (6, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (6, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (6, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (7, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (7, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (7, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (8, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (8, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (8, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (9, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (9, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (9, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (10, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (10, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (10, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (11, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (11, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (11, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (12, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (12, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (12, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (13, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (13, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (13, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (14, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (14, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (14, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (15, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (15, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (15, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (16, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (16, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (16, 3);

INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (17, 1);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (17, 2);
INSERT INTO LEAF_TAG_MAP (LEAF_ID, LEAF_TAG_ID) VALUES (17, 3);
COMMIT;



-- leafId로 태그 조회
SELECT LT.*
FROM (
     SELECT *
     FROM LEAF_TAG_MAP
     WHERE LEAF_ID = 16
) LTM
JOIN LEAF_TAG LT
    ON LT.ID = LTM.LEAF_TAG_ID;

SELECT *
FROM LEAF;



SET FOREIGN_KEY_CHECKS = 0;
TRUNCATE TABLE LEAF;
SET FOREIGN_KEY_CHECKS = 1;


SELECT *
FROM LEAF
WHERE ID = 8;